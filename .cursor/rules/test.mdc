---
description: Vitest/Jest によるテストコードの実装ルール
globs: **/*.test.ts, **/*.test.tsx, **/*.spec.ts, **/*.spec.tsx
alwaysApply: false
---

## テスト基本方針

- 正常系と異常系の両方をテストする
- テストは独立して実行可能にする（他のテストに依存しない）
- テストデータはテスト内で作成し、外部ファイルに依存しない

## テストファイル構成

- テストファイルは対象ファイルと同じディレクトリに配置
- ファイル名は `*.test.ts` または `*.test.tsx` を使用
- `describe` でテスト対象をグループ化
- `it` または `test` でテストケースを記述

## コンポーネントテスト

- `@testing-library/react` を使用
- ユーザー操作は `@testing-library/user-event` を使用
- 実装の詳細ではなく、ユーザーの視点でテストする
- `getByRole`, `getByLabelText` などアクセシビリティに基づくクエリを優先

## モック

- 外部 API は `vi.mock` または `jest.mock` でモック
- Tauri コマンドは `@tauri-apps/api` をモック
- 時間依存のテストは `vi.useFakeTimers` を使用

## カバレッジ

- ビジネスロジックを含む関数は高いカバレッジを目指す
- UI コンポーネントは主要なインタラクションをテスト
- エッジケースとエラーハンドリングをテストに含める
